$legacy-support-for-ie:       false;
$experimental-support-for-opera: false;
$experimental-support-for-mozilla: false;
$experimental-support-for-microsoft: false;

@import "compass";

$touchable-size:              48px; // Default in iOS: "44px"; Android: "48px"
$tablet-breakpoint:           600px; // Nexus 7
$mobile-breakpoint:           320px; // iPhone

$row-width:                   800px;
$total-columns:               4;
$block-grid-elements:         4;
$column-gutter:               $touchable-size / 1.5;
$base-padding:                $column-gutter / 2;
$half-padding:                $column-gutter / 4;
$quarter-padding:             $column-gutter / 8;

$app-border-radius:           0; // Default in iOS 6: "3px";
$app-background:              #fff;
$app-secondary-border-radius: 3px;

$em-base:                     17px;
$small-font-size:             15px;
$smallest-font-size:          13px;
$big-font-size:               26px;
$biggest-font-size:           34px;
$body-font-family:            "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif;
$body-font-color:             #333;
$body-line-height:            1.4;
$body-font-weight-strong:     bold;

$action-bar-height:           $touchable-size;
$action-bar-background-color: #eaeaea;
$action-bar-border-size:      1px;
$action-bar-border-color:     darken($action-bar-background-color, 5%);
$action-bar-text-color:       #666;
$action-bar-text-size:        20px;
$action-bar-icon-size:        20px;

$drawer-width:                260px; // 320px - 60px
$drawer-background:           #22252c;
$drawer-border-right-color:   #121315;
$drawer-text-color:           #eff0f2;
$drawer-text-size:            18px;
$drawer-menu-border-color:    darken($drawer-background, 3%);
$drawer-menu-selected:        darken($drawer-background, 5%);

$filter-box-background-color: #fafafa;
$filter-box-width:            60%;
$filter-box-separation-color: #ddd;

$tableview-detail-font-color: #337abd;
$tableview-border-color:      #eaeaea;

$hr-border-width:             1px;
$hr-border-style:             solid;
$hr-border-color:             #ddd;
$hr-margin:                   ($base-padding * 1.5);

//
// Other rules
//

@import "app-foundation";
@import "app-navigation";
@import "app-colors";
@import "app-icons";
@import "phonegap";

//
// Mixins
//

@mixin small-font() {
    font-size: $small-font-size;
    line-height: 1.3;
}

@mixin smallest-font() {
    font-size: $smallest-font-size;
    line-height: 1.3;
}

@mixin big-font() {
    font-size: $big-font-size;
    line-height: 1.2;
}

@mixin ellipsis() {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

@mixin color-alternation($attribute) {
    &.color-0 {
        #{$attribute}: $color-lightest-blue;
    }
    &.color-1 {
        #{$attribute}: $color-lightest-green;
    }
    &.color-2 {
        #{$attribute}: $color-lightest-violet;
    }
    &.color-3 {
        #{$attribute}: $color-lightest-orange;
    }
    &.color-4 {
        #{$attribute}: $color-lightest-red;
    }
}

//
// Typo
//

h1, h2, h3, h4 {
    margin: .25em 0 .75em;
    font-weight: 300;
    line-height: 1.2;
}

p, ul {
    margin: 0;
    padding: 0;
    line-height: $body-line-height;
}

li {
    list-style: none;
}

a {
    color: darken($color-blue, 10%);
    text-decoration: none;

    &:visited {
        color: $color-blue;
    }
}

//
// Layout
//

body {
    background: $drawer-background;
    line-height: $body-line-height;
}

main, section, section > div {
    background: $app-background;
}

section {
    div.big-message.absolute {
        position: absolute;
        top: $action-bar-height;
        width: 100%;
    }

    div.overthrow {
        padding: $base-padding;

        @media only screen and (min-width: $tablet-breakpoint) {
            padding: ($base-padding * 2);
        }
    }

    div.error {
        position: absolute;
        bottom: 0;
        width: 100%;
        z-index: 1000;

        p {
            @include smallest-font();
            text-align: center;
            background: $color-yellow;
            padding: $half-padding;
            margin: $base-padding;
            @include border-radius($app-secondary-border-radius);
        }
    }

    div.filter-container {
        position: absolute;
        top: $action-bar-height;
        bottom: 0;
        width: 100%;

        .capture-click {
            height: 100%;
            width: 100%;
        }

        .filter-box {
            position: absolute;
            top: 0;
            right: $quarter-padding;
            z-index: 50;
            width: $filter-box-width;
            background: $filter-box-background-color;
            padding: 0 $half-padding;
            @include small-font();
            @include border-bottom-left-radius($app-secondary-border-radius);
            @include border-bottom-right-radius($app-secondary-border-radius);
            box-shadow: 0px 0px 3px 4px rgba(0, 0, 0, 0.15);

            input {
                width: 100%;
                margin: 0 0 $half-padding;
                border: 1px solid $filter-box-separation-color;
                padding: $quarter-padding $half-padding;
                @include border-radius($app-secondary-border-radius);
                @include small-font();
            }

            .section-title {
                text-transform: uppercase;
                @include smallest-font();
                color: $color-lightest-text;
                font-weight: normal;
                margin: 0;
                line-height: 2.5em;

                [class^="icon-"],
                [class*=" icon-"] {
                    float: right;
                    margin-right: 1px;
                }
            }

            li {
                line-height: $touchable-size - $half-padding;
                height: $touchable-size - $half-padding;
                border-top: 1px solid $filter-box-separation-color;
                padding: 0 $half-padding;
                margin: 0 (-($half-padding));
                @include ellipsis();

                [class^="icon-"],
                [class*=" icon-"] {
                    display: none;
                    color: $color-blue;
                    float: right;
                    margin-left: $half-padding;
                }

                &.on {
                    background-color: lighten($color-blue, 40%);

                    [class^="icon-"],
                    [class*=" icon-"] {
                        display: block;
                    }
                }
            }

            &.ng-hide {
                padding: 0;
                border: 0;
            }
        }
    }
}

//
// Border radius
//

@if $app-border-radius != 0 {
    body,
    main,
    section > div {
        @include border-radius($app-border-radius);
        overflow: hidden;
    }
}

//
// Nice borders when menu is open
//

body.active-menu {
    main {
        border-left: 1px solid $drawer-border-right-color;
        
        section > div:first-child {
            border-left: 1px solid #68696b;

            div.overthrow {
                padding-right: ($base-padding - 2px);
            }
        }
    }
}

//
// Action bar
//

header {
    height: $action-bar-height;
    line-height: $action-bar-height;
    background-color: $action-bar-background-color;
    position: relative;
    z-index: 1000;
    
    @if $action-bar-border-size != 0 {
        border-bottom: $action-bar-border-size solid $action-bar-border-color;
    }
    
    .title {
        position:absolute;
        top: 0;
        left: 20%;
        width: 60%;
        margin: 0;
        font-size: $action-bar-text-size;
        font-weight: normal;
        line-height: inherit;
        text-align: center;
        color: $action-bar-text-color;
        @include ellipsis();

        @media only screen and (min-width: $mobile-breakpoint) {
            left: 17%;
            width: 66%;
        }
    }
    
    i {
        background-color: $action-bar-background-color;
        margin: 0 $base-padding;
        font-size: $action-bar-icon-size;
        color: $action-bar-text-color;
    }
}

//
// Drawer
//

ul.drawer {
    background: $drawer-background;
    color: $drawer-text-color;
    font-size: $drawer-text-size;
    
    li {
        height: $touchable-size;
        padding: 0 $base-padding;
        
        a {
            display: block;
            height: $touchable-size;
            line-height: $touchable-size;
            border-bottom: 1px solid $drawer-menu-border-color;
            color: $drawer-text-color;
            @include ellipsis();
            
            [class^="icon-"],
            [class*=" icon-"] {
                margin-right: $base-padding;
                font-size: $drawer-text-size;
            }
            
            &.active {
                background: $drawer-menu-selected;
                margin: 0 (-($base-padding));
                padding: 0 $base-padding;
                margin-top: -1px;
                border-top: 1px solid $drawer-menu-border-color;
            }

            &.settings {
                text-transform: uppercase;
                font-size: $smallest-font-size;
                color: lighten($drawer-background, 25%);
            }
        }
    }
}

//
// TableView
//

.table-view {
    ul {
        border-width: 1px 0;
        border-style: solid;
        border-color: $tableview-border-color;
        margin-right: -($base-padding);

        a {
            display: block;
            color: $body-font-color;
            border-bottom: 1px solid $tableview-border-color;
            height: $touchable-size;
            line-height: $touchable-size;
            padding-right: $base-padding;
            @include ellipsis();

            i {
                float: right;
                color: lighten($body-font-color, 50%);

                &.selected {
                    color: $tableview-detail-font-color;
                }
            }

            .detail {
                float: right;
                color: $tableview-detail-font-color;
                margin-right: $half-padding;
            }
        }

        li:last-child a {
            border: 0;
        }
    }
}

.list-with-images {
    .title {
        margin: 0 $base-padding 0 0;
    }

    .icon-right-open {
        font-size: 1.2em;
        float: right;
        color: $color-lightest-text;
        margin: -3px (-$half-padding) $half-padding $half-padding;
    }

    .thumbnail {
        width: 80%;
        @include border-radius(1000px);
        background: transparent none center;
        background-size: contain;
        @include color-alternation('background-color');

        img {
            width: 100%;
        }
    }

    p {
        @include smallest-font();
        margin-top: $half-padding;

        .distance {
            color: $color-lightest-text;
        }

        .tag {
            display: block;
            float: left;
            margin-right: 0.2em;
        }

        [class^="icon-"],
        [class*=" icon-"] {
            float: left;
            margin: 0 0 0 -3px;
            font-size: .9em;
        }
    }

    hr {
        margin: $base-padding (-$base-padding);
    }

    div.sort-options {
        @include clearfix();
        @include smallest-font();
        font-style: italic;
        line-height: 32px;
        color: $color-lightest-text;

        .bicon {
            text-align: center;
            display: block;
            background: $action-bar-background-color;
            height: 32px;
            width: 40px;
            line-height: 32px;
            @include border-radius($app-secondary-border-radius);
            font-size: $small-font-size;
            margin: 0;
            padding: 0;

            &.icon-direction {
                @include border-top-right-radius(0);
                @include border-bottom-right-radius(0);
            }

            &.icon-sort-alphabet {
                padding-right: 3px;
                @include border-top-left-radius(0);
                @include border-bottom-left-radius(0);
            }

            &.icon-star {
                margin-left: $base-padding;
            }

            &.on {
                background-color: $color-blue;
                color: white;
            }

            &.fav-on {
                background-color: $color-yellow;
                color: white;
            }
        }
    }
}

//
// Icon grid
//

.block-grid-icons {
    li {
        text-align: center;
        margin: $quarter-padding 0 0;

        [class^="icon-"],
        [class*=" icon-"] {
            font-size: $biggest-font-size;
            @include border-radius(1000px);
            height: 1.6em;
            width: 1.6em;
            display: block;
            margin: 0 auto;
            line-height: 1.55;

            @include color-alternation('background-color');
        }

        p {
            padding-top: 5px;
            font-size: $smallest-font-size;
            line-height: 1.3;
            //@include color-alternation('border-top-color');
        }
    }
}

.cta-list {
    margin: $base-padding 0;

    li {
        border-top: 1px solid $hr-border-color;
        height: $touchable-size;
        line-height: $touchable-size;
        margin: 0;
        @include ellipsis();

        [class^="icon-"],
        [class*=" icon-"] {
            display: block;
            font-size: 1.2em;
            color: $color-light-blue;
            float: left;
            margin-right: $half-padding;

            &.right {
                font-size: $smallest-font-size;
                margin: 0 0 0 $half-padding;
                float: right;
                color: $color-lightest-text;
            }
        }

        &:last-child {
            border-bottom: 1px solid $hr-border-color;
        }
    }
}

.star-button {
    font-size: $big-font-size;
    margin: 0 (-($quarter-padding)) 0 $base-padding;
    float: right;
}

//
// Image banner
//

.banner {
    margin: (-($base-padding)) (-($base-padding)) $base-padding;
    height: 200px;
    background: #fafafa none center center no-repeat;
    background-size: cover;
}

//
// Map
//

.map-container {
    position: absolute;
    z-index: 500;
    top: $action-bar-height;
    bottom: 0;
    width: 100%;
    background: $app-background;
    @include transform-transition($transition-duration, ease-out);
    @include transform-translateY(-100%);

    div.active-map & {
        @include transform-translateY(0);
    }

    > div {
        height: 100%;
        width: 100%;

        img {
            max-width: none;
        }
    }
}

//
// Big message
//

.big-message {
    text-align: center;
    padding: 2em 1em;
    font-weight: 300;
    color: $color-lightest-text;
    @include big-font();
    @include transform-translateZ(0);

    [class^="icon-"],
    [class*=" icon-"] {
        display: block;
        font-size: 3em;
        color: #ddd;
        margin-bottom: $base-padding;
    }
}

//
// General text
//

.content {
    h1, h2, h3, h4, h5 {
        font-size: 1em;
        font-weight: normal;
        font-style: italic;

        strong {
            font-weight: normal;
        }
    }

    p, img {
        display: block;
        margin: 1em 0;
    }

    ol, ul {
        padding-left: 1.5em;

        li {
            margin-bottom: .5em;
        }
    }

    ul {
        li {
            list-style: disc outside none;
        }
    }

    ol {
        li {
            list-style: decimal outside none;
        }
    }
}

.external-link {
    @include button(1em, $color-light-blue, $app-secondary-border-radius, true, false, false);
    display: block;
    margin: $column-gutter 0;

    &, &:visited {
        color: white;
    }
}

.post {
    .content {
        div > img + p {
            font-size: .9em;
            color: $color-light-text;
        }

        img {
            width: 100%;
        }
    }
}

//
// Helpers
//

// From Foundation/type
hr {
    border: $hr-border-style $hr-border-color;
    border-width: $hr-border-width 0 0;
    clear: both;
    margin: $hr-margin 0;
    height: 0;
}

.strong {
    font-weight: $body-font-weight-strong;
}

.text-big {
    font-size: $big-font-size;
}

.text-biggest {
    font-size: $biggest-font-size;
}

.text-small {
    @include small-font();
}

.text-smallest {
    @include smallest-font();
}

.text-light {
    font-weight: 300;
}

.ucfirst:first-letter {
    text-transform: uppercase;
}

.uppercase {
    text-transform: uppercase;
}

.lowercase {
    text-transform: lowercase;
}

a.chameleon {
    &, &:hover {
        color: inherit;
        text-decoration: none;
        cursor: default;
    }
}

@import "page-weather";
