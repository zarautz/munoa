<div ng-controller="PlaceViewController as pviewCtrl" ng-class="{ 'active-map': pviewCtrl.mapIsActive }">
    <header>
        <a href ng-click="navigation.popView()"><i class="left icon-left"></i></a>
        <div ng-switch on="pviewCtrl.status.isLoading">
            <div ng-switch-when="true">
                <i class="right icon-spin color-blue animate-spin"></i>
            </div>
            <div ng-switch-default>
                <i ng-click="pviewCtrl.toggleMap();" class="right" ng-class="{ 'icon-location-alt': !pviewCtrl.mapIsActive, 'icon-cancel': pviewCtrl.mapIsActive }"></i>
            </div>
        </div>
        <h1 class="title">{{ pviewCtrl.title }}</h1>
    </header>
    <div ng-if="pviewCtrl.status.isLoading" class="big-message absolute">
        <i class="icon-download"></i>
        {{ 'loading' | translate }}
    </div>
    <div ng-if="!pviewCtrl.status.isLoading" class="overthrow">
        <div class="banner" ng-style="{ 'background-image': 'url('+ pviewCtrl.place.getImage('medium') +')' }"></div>
        <span class="right text-smallest color-lightest-text" ng-if="pviewCtrl.geolocation.available">
            <i class="icon-direction"></i> {{ pviewCtrl.place.location.distanceTo(pviewCtrl.geolocation) | distance }}
        </span>
        <h3>
            {{ pviewCtrl.place.name }}
        </h3>
        <p class="text-small">
            <i class="star-button" ng-click="pviewCtrl.toggleFavorite(pviewCtrl.place.id)" ng-class="{ 'icon-star color-yellow': pviewCtrl.favorite.isFavorite(pviewCtrl.place.id), 'icon-star-empty color-lightest-text': !pviewCtrl.favorite.isFavorite(pviewCtrl.place.id) }"></i>
            {{ pviewCtrl.place.getTypeNamesExcept(['murkil']).join(', ') }}<br />
            <span class="color-light-text">{{ pviewCtrl.place.address }}</span>
        </p>
        <ul class="cta-list">
            <li ng-if="pviewCtrl.place.telephone"
                ng-click="navigation.openExternalLink('tel:'+ pviewCtrl.place.getCleanTelephone())">
                <i class="icon-phone"></i>
                {{ pviewCtrl.place.telephone }}
            </li>
            <li ng-if="pviewCtrl.place.email"
                ng-click="navigation.openExternalLink('mailto:'+ pviewCtrl.place.email)">
                <i class="icon-post"></i>
                {{ pviewCtrl.place.email }}
            </li>
            <li ng-if="pviewCtrl.zarauztarra && pviewCtrl.place.isOfType('murkil')"
                ng-click="navigation.openExternalLink('http://www.murkil.com/index.php?lang='+ pviewCtrl.language)">
                <i class="icon-bag"></i>
                <i class="icon-link-external right"></i>
                {{ 'murkil' | translate }}
            </li>
        </ul>
        <div class="content" ng-bind-html="pviewCtrl.place.description"></div>
    </div>
    <div class="map-container">
        <div munoa-map latitude="{{ pviewCtrl.place.location.latitude }}" longitude="{{ pviewCtrl.place.location.longitude }}"></div>
    </div>
</div>
